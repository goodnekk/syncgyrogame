<!DOCTYPE html>
<html>
    <head>
        <meta charset="utf-8">
        <title></title>
        <script src="gyro.min.js"></script>
        <script src="two.js"></script>
        <script src="/socket.io/socket.io.js"></script>

    </head>
    <body>
        <div id="text"></div>

        <div id="draw-shapes"></div>

        <script type="text/javascript">

        // Make an instance of two and place it on the page.
            var elem = document.getElementById('draw-shapes');
            var params = { width: 800, height: 800 };
            var two = new Two(params).appendTo(elem);
            var rect = two.makeRectangle(0, 0, 800, 800);

            var socket = io();

            socket.on('update', function (data) {
                console.log(data);
            });


            gyro.frequency = 500;
            gyro.startTracking(function(o) {

                //calculate colors
                var colors = {
                    x: (o.x/9.8)*255,
                    y: (o.y/9.8)*255,
                    z: (o.z/9.8)*255
                };

                if(colors.x > 255) colors.x = 255;
                if(colors.y > 255) colors.y = 255;
                if(colors.z > 255) colors.z = 255;

                if(colors.x < 0) colors.x = 0;
                if(colors.y < 0) colors.y = 0;
                if(colors.z < 0) colors.z = 0;

                colors.x = Math.floor(colors.x);
                colors.y = Math.floor(colors.y);
                colors.z = Math.floor(colors.z);

                //update document
                document.getElementById("text").innerHTML = colors.x+", "+colors.y+" ,"+colors.z;
                rect.fill = "rgb("+colors.x+","+colors.y+","+colors.z+")";
                rect.noStroke();
                two.update();

                socket.emit('gyro', {
                    x: o.x,
                    y: o.y,
                    z: o.z
                });
            });
        </script>
    </body>
</html>
